@* PostsList.razor - Renders a list of posts in the home page *@

@if (IsLoading)
{
    @for (int i = 0; i < 3; i++)
    {
        <MudStack Spacing="1" Class="mb-3">
            <MudSkeleton Width="40%" Height="24px" Animation="Animation.Wave" />
            <MudSkeleton Width="90%" Height="18px" Animation="Animation.Wave" />
            <MudSkeleton Width="20%" Height="14px" Animation="Animation.Wave" />
        </MudStack>
    }
}
else
{
    @foreach (var post in Posts)
    {
        <MudLink Href="@post.Href" Underline="Underline.None" Color="Color.Inherit" data-umami-event='@UmamiEvent.ClickValue(post.Title, "post")'>
            <MudStack Spacing="1" Class="mb-3 hover-card">
                <MudText Typo="Typo.h6" Style="font-weight: 600;">@post.Title</MudText>
                <MudText Typo="Typo.body2" Color="Color.Secondary">@post.Summary</MudText>
                <MudText Typo="Typo.caption" Color="Color.Secondary">
                    @FormatDate(post.PublishedAt)
                </MudText>
            </MudStack>
        </MudLink>
    }
}

@code {
    [Parameter] public List<ContentMetadata> Posts { get; set; } = new();
    [Parameter] public bool IsLoading { get; set; }

    private static string FormatDate(string dateStr)
    {
        if (DateTime.TryParse(dateStr, out var d))
            return d.ToString("ddd MMM dd yyyy");
        return dateStr;
    }
}
