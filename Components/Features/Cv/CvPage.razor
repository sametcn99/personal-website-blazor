@page "/cv"
@using Markdig

<PageTitle>CV | Samet Can Cıncık</PageTitle>

<HeadContent>
    <meta name="description" content="View my CV, experience, skills, and downloadable resume files in Turkish and English." />
</HeadContent>

<MudContainer  >
    <BackToHome />

    <article class="mt-4">
        @if (string.IsNullOrWhiteSpace(_htmlContent))
        {
            <MudSkeleton Width="100%" Height="60px" Animation="Animation.Wave" Class="mb-6" />
            <MudSkeleton Width="100%" Height="150px" Animation="Animation.Wave" Class="mb-6" />
            <MudSkeleton Width="80%" Height="100px" Animation="Animation.Wave" Class="mb-6" />
        }
        else
        {
            <MudHtmlRenderer HtmlContent="@_htmlContent" />
        }
    </article>

    @if (!string.IsNullOrWhiteSpace(_htmlContent))
    {
        <MudStack Row Justify="Justify.FlexEnd" Spacing="2" Class="mt-4 mb-4 d-print-none">
            <MudMenu Variant="Variant.Outlined" Color="Color.Primary" AnchorOrigin="Origin.BottomRight" TransformOrigin="Origin.TopRight" Style="text-transform: none;">
                <ActivatorContent>
                    <MudButton Variant="Variant.Outlined" Color="Color.Primary"
                               StartIcon="@Icons.Material.Filled.Download"
                               EndIcon="@Icons.Material.Filled.KeyboardArrowDown"
                               Style="text-transform: none;">
                        Download CV
                    </MudButton>
                </ActivatorContent>
                <ChildContent>
                    <MudMenuItem Target="_blank" Href="/Samet_Can_Cincik_CV_TR.pdf" download="Samet_Can_Cincik_CV_TR.pdf" data-umami-event="cv-download-tr-click">
                        Özgeçmiş (TR)
                    </MudMenuItem>
                    <MudMenuItem Target="_blank" Href="/Samet_Can_Cincik_CV_EN.pdf" download="Samet_Can_Cincik_CV_EN.pdf" data-umami-event="cv-download-en-click">
                        Resume (EN)
                    </MudMenuItem>
                </ChildContent>
            </MudMenu>
        </MudStack>
    }
</MudContainer>

@code {
    [Inject] private IWebHostEnvironment Env { get; set; } = default!;

    private string _htmlContent = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        var path = Path.Combine(Env.ContentRootPath, "content", "cv.mdx");
        if (File.Exists(path))
        {
            var markdown = await File.ReadAllTextAsync(path);
            var pipeline = new MarkdownPipelineBuilder()
                .UseAdvancedExtensions()
                .Build();
            _htmlContent = Markdown.ToHtml(markdown, pipeline);
        }
    }
}
